{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"imrabo AI SDK","text":"<p>Welcome to the imrabo AI SDK documentation (Python). This site documents the public API, design principles, provider adapter rules, and examples to help you implement and consume the SDK.</p> <p>Use the Getting Started page to install and make your first call.</p> <p>The SDK is intentionally small and boring: two public functions \u2014 <code>generate</code> and <code>stream</code> \u2014 and a strict provider contract.</p>"},{"location":"PR_CHECKLIST/","title":"PR Review Checklist \u2014 imrabo AI SDK","text":"<p>Use this checklist for every PR touching <code>src/</code> or <code>docs/</code>.</p> <ul> <li>\u2705 Public API unchanged \u2014 No renames or semantic changes to <code>generate</code> / <code>stream</code> / types in <code>imrabo_ai_sdk.types</code>.</li> <li>\u2705 No provider logic in core \u2014 <code>imrabo_ai_sdk/core/*</code> must not import <code>providers</code>.</li> <li>\u2705 Capabilities enforced \u2014 All places that invoke providers must validate capabilities first.</li> <li>\u2705 Streaming parity \u2014 Streaming behavior must be tested; providers must stream tokens incrementally.</li> <li>\u2705 No TODOs in src/ \u2014 Remove any TODO/FIXME from source files before merge.</li> <li>\u2705 Typed errors \u2014 Errors must be one of the typed SDK errors and deterministic.</li> <li>\u2705 Tests added/updated \u2014 New behavior must be covered by deterministic tests.</li> <li>\u2705 Docs updated \u2014 Update <code>docs/</code> if any public behavior changes.</li> <li>\u2705 No forbidden concepts \u2014 Ensure PR does not introduce agents, storage, vector DBs, process management, CLI, UI, or editor hooks.</li> </ul> <p>If all checks pass, the PR is approved for merge.</p>"},{"location":"RELEASE_NOTES_TEMPLATE/","title":"Release Notes Template","text":""},{"location":"RELEASE_NOTES_TEMPLATE/#summary","title":"Summary","text":"<p>A short one-paragraph summary of the release.</p>"},{"location":"RELEASE_NOTES_TEMPLATE/#notable-changes","title":"Notable Changes","text":"<ul> <li>Added: ...</li> <li>Fixed: ...</li> <li>Changed: ...</li> </ul>"},{"location":"RELEASE_NOTES_TEMPLATE/#migration-notes","title":"Migration Notes","text":"<ul> <li>If anything requires migration, call it out here.</li> </ul>"},{"location":"RELEASE_NOTES_TEMPLATE/#ci","title":"CI","text":"<ul> <li>Confirmed tests passing on Python 3.10, 3.11</li> </ul>"},{"location":"contributing/","title":"Contributing","text":"<p>Thanks for considering contributing. A few project rules to follow:</p> <ul> <li>Keep the SDK small and boring: do not add execution, agents, persistence, or CLI logic.</li> <li>Do not add provider-specific flags to public types.</li> <li>Validate capabilities before invocation and add tests for capability enforcement.</li> <li>Core (under <code>imrabo_ai_sdk/core</code>) must not import <code>providers</code>.</li> <li>Add tests and update docs for any public change.</li> </ul> <p>Run tests and lint locally:</p> <pre><code>python -m pip install -e .[docs]\npython -m pip install -r requirements-dev.txt  # if present\npython -m ruff check .\npython -m pytest\n</code></pre> <p>Before creating a release see <code>RELEASE.md</code> and ensure the CHANGELOG and docs are updated.</p>"},{"location":"getting-started/","title":"Getting Started","text":"<p>Install from PyPI:</p> <pre><code>pip install imrabo-ai-sdk\n</code></pre> <p>Basic usage:</p> <pre><code>from imrabo_ai_sdk import generate\nfrom imrabo_ai_sdk.types import GenerateRequest, Message, RuntimeConfig\n\nreq = GenerateRequest(\n    model='gpt-xyz',\n    messages=[Message(role='user', content='Hello')],\n    runtime=RuntimeConfig(type='url', endpoint='http://example.com')\n)\n\nres = generate(req)\nprint(res.output)\n</code></pre> <p>Streaming example:</p> <pre><code>from imrabo_ai_sdk import stream\nfor chunk in stream(req):\n    if chunk.type == 'token':\n        print(chunk.value, end='')\n    elif chunk.type == 'done':\n        print('\\n-- done --')\n</code></pre> <p>Docs are available under <code>docs/</code> in the repository and deployed to GitHub Pages when pushed to <code>main</code> (via the docs workflow).</p>"},{"location":"provider_adapters/","title":"Provider Adapter Guidelines","text":"<p>This document explains how to implement a provider adapter for the imrabo AI SDK.</p> <p>Requirements: - Implement the <code>Provider</code> protocol from <code>imrabo_ai_sdk.types</code>. - Declare explicit <code>Capabilities</code>. - Do not mutate <code>InternalRequest</code>. - Do not hold persistent state, do not import other providers. - Streaming must follow the <code>StreamChunk</code> semantics.</p> <p>Anti-patterns: - Adding provider-specific flags to public types. - Swallowing errors or retrying silently. - Performing filesystem or process management.</p> <p>Kernel Provider: - Kernel provider is a stub in v1. It MUST raise NotImplementedError for both <code>generate</code> and <code>stream</code>. - Kernel providers are optional and intended for future local execution support; they are not special-cased by the core.</p>"},{"location":"sdk-contract/","title":"imrabo-ai-sdk \u2014 SDK Contract (Formal Spec)","text":"<p>Locked specification for the imrabo AI SDK public API, extension surfaces, provider contract, and conformance tests. This document is the canonical source for implementers and reviewers.</p>"},{"location":"sdk-contract/#0-purpose-scope","title":"0. Purpose &amp; Scope \ud83d\udd12","text":"<p>This document defines the API contract for the imrabo AI SDK. The SDK is a provider-agnostic invocation layer that exposes a single stable surface for calling AI models (local or remote) and does not own execution.</p> <p>Non-goals (explicit): runtime management, process management, agent frameworks, memory and persistence, UI, or CLIs. The SDK is purely an invocation and normalization layer.</p>"},{"location":"sdk-contract/#1-high-level-principles-referenced-in-docssdk-principlesmd","title":"1. High-level Principles (referenced in <code>docs/sdk-principles.md</code>) \u2705","text":"<ul> <li>Invocation over execution</li> <li>Capabilities over promises</li> <li>Streaming first</li> <li>URL-first, kernel-second</li> <li>Adapters adapt \u2014 core never bends</li> <li>Additive evolution only</li> </ul> <p>These rules are normative and must be enforced by validation and tests.</p>"},{"location":"sdk-contract/#2-public-api-v1-the-product-surface","title":"2. Public API (v1) \u2014 The Product Surface \u2728","text":""},{"location":"sdk-contract/#21-entry-points","title":"2.1 Entry Points","text":"<p>The SDK exposes exactly these two public operations:</p> <pre><code>// core/generate.ts\nexport function generate(request: GenerateRequest): Promise&lt;GenerateResult&gt;\n\n// core/stream.ts\nexport function stream(request: GenerateRequest): AsyncIterable&lt;StreamChunk&gt;\n</code></pre> <p>No additional helpers, provider-specific shims, or sugar functions are part of the public v1 surface.</p>"},{"location":"sdk-contract/#22-types-public-frozen","title":"2.2 Types \u2014 Public (frozen)","text":"<pre><code>interface GenerateRequest {\n  model: string\n  messages: Message[]\n\n  runtime?: RuntimeConfig\n  tools?: ToolDefinition[]\n  options?: GenerationOptions\n}\n\ninterface Message {\n  role: 'system' | 'user' | 'assistant'\n  content: string\n}\n\ninterface RuntimeConfig {\n  type: 'url' | 'kernel'\n  endpoint?: string        // http(s)://... (required for type=url)\n  headers?: Record&lt;string, string&gt;\n  timeoutMs?: number\n}\n\ninterface GenerationOptions {\n  maxTokens?: number\n  temperature?: number\n  topP?: number\n  stop?: string[]\n}\n\ninterface GenerateResult {\n  output: string\n  tokens?: number\n  metadata?: Record&lt;string, any&gt;\n}\n</code></pre> <p>Rules: no provider-specific fields allowed in these interfaces. Default values are not implied by the SDK \u2014 callers must supply explicit choices where needed.</p>"},{"location":"sdk-contract/#3-streaming-model-non-negotiable","title":"3. Streaming Model (non-negotiable) \u26a1\ufe0f","text":"<p>Streaming is a first-class mode. The public <code>stream</code> operation returns an AsyncIterable of StreamChunk:</p> <pre><code>interface StreamChunk {\n  type: 'token' | 'tool_call' | 'done' | 'error'\n  value?: string | ToolCall\n}\n</code></pre> <p>Rules: - Tokens must arrive incrementally in the order they are generated. - Providers that cannot stream must set <code>capabilities().streaming === false</code>. - If a caller requests streaming but the resolved provider reports streaming=false, the SDK must throw <code>UnsupportedCapabilityError</code> (no silent downgrade). - <code>done</code> is sent once when generation is complete; <code>error</code> may be emitted as the final chunk for streaming errors. - Tool interactions (if supported) are flagged via <code>tool_call</code> chunk type.</p> <p>Note: The SDK does not standardize wire-level SSE vs chunked vs websocket \u2014 that is a provider implementation detail. The provider must expose streaming semantics through the <code>stream</code> method defined in the provider contract.</p>"},{"location":"sdk-contract/#4-capabilities-system-contract","title":"4. Capabilities System (contract)","text":"<pre><code>interface Capabilities {\n  streaming: boolean\n  tools: boolean\n  json: boolean\n  maxTokens?: number\n}\n</code></pre> <p>Enforcement rules: - The SDK checks <code>provider.capabilities()</code> prior to execution. - If the request asks for a feature not supported by the provider (e.g., <code>tools</code> or streaming), the SDK throws <code>UnsupportedCapabilityError</code> with deterministic messaging. - Capability checks are deterministic and must be exercised early.</p>"},{"location":"sdk-contract/#5-provider-adapter-contract-only-extension-point","title":"5. Provider Adapter Contract (ONLY extension point) \ud83d\udd0c","text":"<pre><code>interface Provider {\n  id: string\n\n  capabilities(): Capabilities\n\n  generate(req: InternalRequest): Promise&lt;GenerateResult&gt;\n\n  stream(req: InternalRequest): AsyncIterable&lt;StreamChunk&gt;\n}\n</code></pre> <p>Hard rules for providers: - A provider must be a pure implementation: no side effects, no internal persistent state, and no importing other providers. - Providers MUST NOT mutate incoming requests; SDK sends a normalized InternalRequest. - Providers must not swallow or transform errors silently; they must raise typed errors as specified. - Providers must not perform automatic retries unless explicitly exposed by configuration (and such behavior must be transparent to the SDK and tests).</p> <p>Provider Registration: - Providers are registered in <code>providers/index.ts</code> and loaded by <code>config/resolveProvider.ts</code> using deterministic rules (e.g., <code>runtime.type</code> and <code>runtime.endpoint</code> for url types).</p>"},{"location":"sdk-contract/#6-internal-request-normalization-and-validation","title":"6. Internal Request Normalization and Validation \u2705","text":"<p>Public requests are normalized into <code>InternalRequest</code> before being passed to providers.</p> <pre><code>interface InternalRequest {\n  model: string\n  messages: Message[]\n  tools?: ToolDefinition[]\n  options?: GenerationOptions\n}\n</code></pre> <p>Normalizer responsibilities: - Validate message ordering and role values. - Enforce or check <code>options.maxTokens</code> against provider <code>capabilities().maxTokens</code> if present. - Reject unsupported combinations (e.g., tools requested when provider has tools=false). - Produce deterministic, immutable InternalRequest objects for providers to consume.</p> <p>All validation errors raised here are <code>SDKValidationError</code> with deterministic messages and error codes for programmatic handling.</p>"},{"location":"sdk-contract/#7-error-model-typed-deterministic","title":"7. Error Model (typed &amp; deterministic) \ud83d\udea8","text":"<p>Error types (exported): - <code>SDKValidationError</code> - <code>UnsupportedCapabilityError</code> - <code>ProviderError</code> - <code>TransportError</code> - <code>TimeoutError</code></p> <p>Guidelines: - All errors must contain a machine-friendly <code>code</code> string and a deterministic human message. - Providers should wrap provider-specific errors in <code>ProviderError</code> with a consistent shape: <code>{ code, message, providerId, details? }</code>. - SDK must never swallow or obfuscate provider errors.</p> <p>Example error object:</p> <pre><code>{\n  \"name\": \"UnsupportedCapabilityError\",\n  \"code\": \"streaming_not_supported\",\n  \"message\": \"Provider 'foo' does not support streaming\",\n  \"provider\": \"foo\"\n}\n</code></pre>"},{"location":"sdk-contract/#8-internal-architecture-import-rules","title":"8. Internal Architecture &amp; Import Rules \ud83c\udfd7\ufe0f","text":"<p>Minimal structure (implementation folder names are normative):</p> <pre><code>core/\n  generate.ts\n  stream.ts\n  validate.ts\n  normalize.ts\n  capabilities.ts\n  errors.ts\nproviders/\n  generic_url.ts  // MUST be first\n  ollama.ts\n  kernel.ts       // later\n  index.ts\ntransport/\n  http.ts\n  streaming.ts\nconfig/\n  resolveProvider.ts\ndocs/\n  sdk-contract.md\n</code></pre> <p>Import rules: - <code>core</code> must not import from <code>providers</code>. - <code>providers</code> may depend on <code>transport</code> but not on <code>core</code> or other providers. - <code>transport</code> must not contain SDK logic; it's focused on HTTP and streaming primitives.</p> <p>Violation of these rules is considered an architectural bug.</p>"},{"location":"sdk-contract/#9-provider-implementation-order-recommended","title":"9. Provider Implementation Order (recommended)","text":"<p>Phase 1 \u2014 Generic URL Provider (MANDATORY FIRST) - Implement <code>providers/generic_url.ts</code> that supports an opinionated mapping to common HTTP AI endpoints (OpenAI-compatible, OpenCode-style, Ollama-style). This demonstrates the correctness of the adapter contract.</p> <p>Phase 2 \u2014 Ollama Provider - Thin implementation with streaming-first semantics and compatibility tests against the local Ollama server.</p> <p>Phase 3 \u2014 Kernel Provider (optional) - Local kernel adapter; only after core has stabilized.</p>"},{"location":"sdk-contract/#10-conformance-tests-acceptance-criteria","title":"10. Conformance Tests &amp; Acceptance Criteria \u2705","text":"<p>A provider is conformant when it passes both unit and integration tests. Minimum test cases:</p> <p>Public contract tests (core): - <code>generate()</code> rejects invalid message sequences and role values (SDKValidationError). - <code>stream()</code> throws <code>UnsupportedCapabilityError</code> when provider.streaming === false. - Normalization enforces token limits when capability declares <code>maxTokens</code>. - Error types and codes are preserved through the stack.</p> <p>Provider tests (generic URL &amp; Ollama): - Provider.capabilities() returns correct capabilities for the configured runtime. - <code>stream()</code> yields <code>token</code> chunks incrementally for streaming endpoints. - <code>generate()</code> returns same final text as streamed <code>done</code> concatenation. - <code>tool_call</code> chunks appear when a provider supports tools and the model emits a tool invocation.</p> <p>Integration tests: - Switch runtime between Ollama/OpenAI/URL via <code>RuntimeConfig</code> only and verify identical API behavior. - Streaming parity tests: ensure <code>generate()</code> and <code>stream()</code> produce consistent outputs and metadata.</p> <p>Acceptance criteria (same as Completion Criteria in the design document): 1. User can swap providers via configuration only. 2. Streaming works identically across providers. 3. Unsupported features fail loudly. 4. No daemon required. 5. CLI can be built on top of the SDK without modifying providers.</p>"},{"location":"sdk-contract/#11-versioning-compatibility-policy","title":"11. Versioning &amp; Compatibility Policy","text":"<ul> <li>v1 is additive-only. Fields cannot be renamed or reinterpreted in v1.</li> <li>Any breaking changes require a v2 with an explicit migration plan.</li> <li>Tests must be written that assert backwards compatibility for minor releases.</li> </ul>"},{"location":"sdk-contract/#12-security-privacy-notes","title":"12. Security &amp; Privacy Notes \ud83d\udd10","text":"<ul> <li>The SDK itself makes no assumptions about model safety or content moderation. Those are the caller's responsibility.</li> <li>Providers must not leak local secrets in error messages or metadata. Providers should sanitize headers and sensitive values before including them in logs or errors.</li> </ul>"},{"location":"sdk-contract/#13-documentation-onboarding","title":"13. Documentation &amp; Onboarding","text":"<ul> <li><code>docs/sdk-principles.md</code> contains the frozen principles (copy the list from the design doc).</li> <li><code>docs/sdk-contract.md</code> (this file) is the official spec and is authoritative for reviewers and implementers.</li> <li>Add a small <code>examples/</code> folder with minimal <code>generate</code> and <code>stream</code> examples for each provider.</li> </ul>"},{"location":"sdk-contract/#14-conformance-checklist-quick","title":"14. Conformance Checklist (quick) \u2705","text":"<ul> <li>[ ] <code>generate</code> and <code>stream</code> implemented</li> <li>[ ] Normalizer validates messages and roles</li> <li>[ ] Capabilities checked before provider invocation</li> <li>[ ] Provider contract documented and enforced in tests</li> <li>[ ] Streaming parity tests present</li> <li>[ ] Error types present and deterministic</li> <li>[ ] <code>docs/sdk-principles.md</code> authored</li> </ul>"},{"location":"sdk-contract/#15-final-lock-statement","title":"15. Final Lock Statement","text":"<p>The SDK is a contract, not a product feature. It must be boring, strict, and predictable. Breaking these rules requires a documented migration path and a v2.</p> <p>End of spec.</p>"},{"location":"sdk_contract/","title":"imrabo AI SDK \u2014 SDK Contract (Python)","text":"<p>This document is the authoritative specification for the Python SDK implementation. It mirrors the locked design and includes the public API, types, streaming model, error model, conformance tests, and provider contract.</p> <p>(See repository <code>docs/</code> for the canonical spec used for implementation and tests.)</p> <p>Public API</p> <ul> <li>generate(request: GenerateRequest) -&gt; GenerateResult</li> <li>stream(request: GenerateRequest) -&gt; Iterable[StreamChunk]</li> </ul> <p>Streaming model</p> <ul> <li>Tokens emitted as <code>StreamChunk(type='token', value=...')</code></li> <li><code>done</code> chunk emitted at end</li> <li>Errors raised or streamed as <code>StreamChunk(type='error')</code> where applicable</li> </ul> <p>Provider adapter rules</p> <ul> <li>Providers implement the <code>Provider</code> Protocol in <code>imrabo_ai_sdk.types</code></li> <li>Providers must be stateless and not mutate requests</li> <li>Capabilities must be declared and enforced by the core</li> </ul> <p>Error model</p> <ul> <li>SDKValidationError</li> <li>UnsupportedCapabilityError</li> <li>ProviderError</li> <li>TransportError</li> <li>TimeoutError</li> </ul> <p>Conformance tests</p> <ul> <li>Core validation tests (message roles, generation options)</li> <li>Streaming tests (token order, done, errors)</li> <li>Provider tests (mock transport)</li> <li>Integration parity tests</li> </ul> <p>This file exists to assist reviewers and implementers; it should be kept in sync with <code>docs/sdk_principles.md</code> and <code>docs/provider_adapters.md</code>.</p>"},{"location":"sdk_principles/","title":"SDK Principles (frozen)","text":"<ol> <li>Invocation over execution</li> <li>Capabilities over promises</li> <li>Streaming first</li> <li>URL-first, kernel-second</li> <li>Adapters adapt \u2014 core never bends</li> <li>Additive evolution only</li> </ol> <p>Non-goals: - Not a runtime - Not a process manager - Not a chat UI - Not an agent framework - Not a memory store</p> <p>Enforcement: these principles are normative and must be tested and referenced by PR reviewers.</p>"},{"location":"sdk_principles/#quick-checklist-for-reviewers","title":"Quick checklist for reviewers","text":"<ul> <li>Does core contain provider logic? (No)</li> <li>Do providers mutate requests? (No)</li> <li>Are capabilities validated before use? (Yes)</li> <li>Does sdk export exactly <code>generate</code> and <code>stream</code>? (Yes)</li> </ul>"},{"location":"usage/","title":"Usage","text":"<p>This page collects examples, best practices and notes about using the SDK.</p> <ul> <li>Public functions: <code>generate(request: GenerateRequest) -&gt; GenerateResult</code>, <code>stream(request: GenerateRequest) -&gt; Iterable[StreamChunk]</code></li> <li>Always validate your runtime and model values before calling the SDK.</li> <li>If you request streaming but your runtime/provider does not support streaming, the SDK raises <code>UnsupportedCapabilityError</code>.</li> </ul> <p>Refer to <code>docs/sdk_contract.md</code> for full type definitions and examples.</p>"}]}